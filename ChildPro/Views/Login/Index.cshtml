
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link href="~/Content/logina.css" rel="stylesheet" />
    <link href="~/fonts/iconfont.css" rel="stylesheet" />
    <style type="text/css">
        body{
            padding: 0;
            color: #202124;
            margin: 0;
            line-height: 1.4286;
            font-size: 15px;
            background-color: #fff;
        }
    </style>
    <title>少儿编程 - 登录</title>
</head>
<body>
    <div class="wrapper">
        <div class="in_middle">
            <div class="ani_pass" aria-hidden="true">
                <div class="ani_pass_wrap qu_like">
                    <div class="myvh TKo lpp">
                        <span class="qq SQ lpp"></span>
                    </div>
                    <div class="myvh TKP lpp">
                        <span class="qq RQ lpp"></span>
                    </div>
                </div>
            </div>
            <div class="login_box">
                <div class="logo">
                    <img src="~/img/logo.jpg" width="95" height="57.6" />
                </div>
                <div class="login-wrapper">
                    <div class="login_inner">
                        <div class="login_padd">
                            <div class="login_title">
                                <div class="cen">
                                    <h1 class="headingText">
                                        <content>登录</content>
                                    </h1>
                                    <div class="footerText">
                                        <content>继续使用 Gmail</content>
                                    </div>
                                </div>
                            </div>
                            <div class="login_input">
                                <div class="UI_pamar">
                                    <div class="write_input">
                                        <div>
                                            <form method="post" class="login-form">
                                                <section>
                                                    <div class="input_wrapper">
                                                        <div class="wrapper_a fir">
                                                            <div class="input-wrap">
                                                                <div class="fixedheight">
                                                                    <div class="inner-static-block">
                                                                        <div class="finel">
                                                                            <input type="email"
                                                                                   autocomplete="off"
                                                                                   spellcheck="false"
                                                                                   aria-label="电子邮件地址或者电话号码"
                                                                                   name="identify"
                                                                                   dir="ltr"
                                                                                   tabindex="0"
                                                                                   class="em_or_phone input_for_login" />
                                                                            <div class="show-inf animate-inf" aria-hidden="true">电子邮件地址或电话号码</div>
                                                                        </div>
                                                                        <div class="lpl coverss"></div>
                                                                        <div class="bod"></div>
                                                                    </div>
                                                                </div>
                                                                <div class="error-title">
                                                                    <div class="error-tip">
                                                                        <div class="err-text">

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="wrapper_a thr">
                                                            <div class="input-wrap">
                                                                <div class="fixedheight">
                                                                    <div class="inner-static-block">
                                                                        <div class="finel">
                                                                            <input type="password"
                                                                                   autocomplete="off"
                                                                                   spellcheck="false"
                                                                                   aria-label="密码"
                                                                                   maxlength="20"
                                                                                   name="password"
                                                                                   dir="ltr"
                                                                                   tabindex="1"
                                                                                   class="pass_word input_for_login" />
                                                                            <div class="show-inf animate-inf" aria-hidden="true">密码</div>
                                                                        </div>
                                                                        <div class="lpl coverss"></div>
                                                                        <div class="bod"></div>
                                                                    </div>
                                                                </div>
                                                                <div class="error-title">
                                                                    <div class="error-tip">
                                                                        <div class="err-text ps_pop">

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="forget">
                                                            <button type="button" class="for_btn">忘记了电子邮件地址？</button>
                                                        </div>
                                                    </div>
                                                </section>
                                            </form>
                                        </div>
                                    </div>
                                    <div class="login_to">
                                        <div class="login_to_wrap">
                                            <div class="login_Dl">
                                                <div class="login_Dl_wrap">
                                                    <button class="BlueDL DL">登陆</button>
                                                </div>
                                            </div>
                                            <div class="CreateCount">
                                                <div class="Create_btn" role="link">
                                                    <span>创建账号</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="Retrieve hidden">
                    <div class="login_padd">
                        <div class="login_title">
                            <div class="cen">
                                <h1 class="headingText">
                                    <content>查找您的电子邮件地址</content>
                                </h1>
                                <div class="footerText">
                                    <content>请输入您的电话号码或辅助邮箱</content>
                                </div>
                            </div>
                        </div>
                        <div class="login_input">
                            <div class="UI_pamar">
                                <div class="write_input">
                                    <div>
                                        <form method="post" class="login-form">
                                            <section>
                                                <div class="input_wrapper">
                                                    <div class="wrapper_a fir">
                                                        <div class="input-wrap">
                                                            <div class="fixedheight">
                                                                <div class="inner-static-block">
                                                                    <div class="finel">
                                                                        <input type="email"
                                                                               autocomplete="off"
                                                                               spellcheck="false"
                                                                               aria-label="电子邮件地址或者电话号码"
                                                                               name="identify"
                                                                               dir="ltr"
                                                                               class="em_or_phone_re input_for_login" />
                                                                        <div class="show-inf animate-inf" aria-hidden="true">电话号码或者辅助邮箱地址</div>
                                                                    </div>
                                                                    <div class="lpl coverss"></div>
                                                                    <div class="bod"></div>
                                                                </div>
                                                            </div>
                                                            <div class="error-title">
                                                                <div class="error-tip">
                                                                    <div class="err-text">

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </section>
                                        </form>
                                    </div>
                                </div>
                                <div class="login_area">
                                    <div class="login_ok">
                                        <div class="ok_btn" role="button">
                                            <button class="BlueDL next_for">下一步</button>
                                        </div>
                                    </div>
                                    <div class="Ret">
                                        <div role="link" class="login_link Retu">
                                            返回登陆
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script type="text/javascript">
    $(function () {
        $('input').each(function () {
            var p=$(this).parents('.input-wrap');
            $(this).on('focus',function () {
                p.addClass('opk usb-ani');
            }).on('blur',function () {
                var content=$(this).val().trim();
                if(p.is('.usb-ani.opk') && !!content){
                    p.removeClass('usb-ani');
                }else{
                    p.removeClass('opk usb-ani');
                }
            })
        })
    })
    </script>
    <script type="text/javascript">
    function ani(){
        console.log("开始动画");
        var def=$.Deferred();
        $('.ani_pass_wrap').toggleClass('qu_like');
        $('.lpp').css({
            'animation-play-state':'running'
        });
        def.resolve("1000ms后停止");
        return def.promise();
    }
    function stop_ani(data){
        console.log(data);
        var def=$.Deferred();
        setTimeout(function () {
            $('.ani_pass_wrap').toggleClass('qu_like');
            $('.lpp').css({
                'animation-play-state':'paused'
            });
            def.resolve("动画已经停止,接下来隐藏login");
        },1000);
        return def.promise();
    }
    $('.login_box').on('click','.for_btn',function () {
        ani()
            .then(stop_ani,(error)=>{
                console.log(error);
            })
            .then((data)=>{
                console.log(data);
                $('.login-wrapper').hide();
                $('.Retrieve').fadeIn();
            })
    })
    //click事件
    $('.login_box').on('click','.Retu',function () {
        $('.Retrieve').hide();
        $('.login-wrapper').fadeIn();
    });
    //mouseout事件
    $('.login_box').on('mouseout','.Retu',function () {
        var self=$(this);
        self.addClass('leave');
        setTimeout(function () {
            self.removeClass('leave')
        },500);
    });
    </script>
    <script type="text/javascript">
        $('.Create_btn').on('click', function () {
            window.location.href = '/Register/Index';
        });

        $('.DL').on('click', function () {
            var checkover = 0;
            var phoneOrEmail = $('.em_or_phone').val().trim();
            var password = $('.pass_word').val().trim();
            var err_1 = '<p class="err_p"><i class="iconfont iconjinggao" style="font-size: 20px"></i>&nbsp;邮箱地址或电话不能为空' + '</p>';
            var err_2 = '<p class="err_p"><i class="iconfont iconjinggao" style="font-size: 20px"></i>&nbsp;密码不能为空' + '</p>';
            var err_3 = '<p class="err_p"><i class="iconfont iconjinggao" style="font-size: 20px"></i>&nbsp;密码错误，请重新输入' + '</p>';
            var fir = true;
            $('.input_for_login').each(function () {
                $_this = $(this);
                var val = $_this.val().trim();
                //聚焦第一个空input
                if (!val && fir) {
                    $_this.focus();
                    fir = false;
                }
                var err_text = $_this.parents('.fixedheight').next().find('.err-text');
                var err_p = $_this.parents('.fixedheight').next().find('.err_p');
                if (!val && !err_p.length) {
                    if ($_this.is('.em_or_phone')) {
                        err_text.append(err_1);
                    } else if ($_this.is('.pass_word')) {
                        err_text.append(err_2);
                    }
                } else if (!!val) {
                    err_text.empty();
                    checkover += !!val;
                }
            });

            if (checkover == 2) {
                var loginObj = {
                    key: $('.em_or_phone').val().trim(),
                    password:$('.pass_word').val().trim()
                };
                $.ajax({
                    url:'/Login/Index',
                    type: 'post',
                    contentType: 'application/json;charset=utf-8',
                    data: JSON.stringify(loginObj),
                    success: function (res) {
                        console.log(res.message);
                        if (res.code == 200) {
                            //登陆成功
                            window.location.href = '/Home/Index';
                        }else{
                            //邮箱或密码错误
                            var err_p = $('.ps_pop').children('.err_p').length;
                            if(!err_p){
                                $('.ps_pop').append(err_3);
                            }
                        }
                    },
                    error: function () {
                        console.log('登陆失败');
                    }
                })
            }
        })
    </script>
</body>
</html>
